---
hide:
  - navigation
#   - toc
---

<p align="center">
<svg width="182" height="35" viewBox="0 0 182 35" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<rect width="182" height="35" fill="url(#pattern0)"/>
<defs>
<pattern id="pattern0" patternContentUnits="objectBoundingBox" width="1" height="1">
<use xlink:href="#image0_331_118" transform="scale(0.00243427 0.0126582)"/>
</pattern>
<image id="image0_331_118" width="411" height="79" xlink:href="data:image/png;base64,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"/>
</defs>
</svg>
</p>

<p align="center">
    <em>The purest architecture, intuitive EList, smart queries, concise syntax</em>
</p>

---

**Documentation**: <a href="https://epurelib.github.io/docs/" target="_blank">https://epurelib.github.io/latest/</a>

**Source Code**: <a href="https://github.com/nagvalhm/epure" target="_blank">https://github.com/nagvalhm/epure</a>

---

Epure is python type-based ORM - you can store and retrieve data having no idea about database, table and columns. 
All technical details hidden from you. Care only about your business logic.

Key features:

<!-- * **Concise**: Magic way to build flexible and smart queries -->
<!-- * **Concise**: Shortest way to build :magic_wand: _magic_ :magic_wand: queries -->
<!-- * **Concise**: Straight-to-the-point building :magic_wand: _magic_ :magic_wand: queries -->
<!-- * **Concise**: Straight-to-the-point way of building queries -->
<!-- * **Concise**: Smartest way in building :magic_wand: _magic_ :magic_wand: queries -->
<!-- * **Lightweight structure**: Contrary to other python ORM - in Epure you have freedom to make structure for your project whatever you like -->
<!-- * **Customizable**: Save your Epure in all forms and shapes -->
* **Convenient**: Many useful and intuitive tools, like Elist, Eset, JoinResource and many more
* **Fast**: Create tables based on your classes in no time
* **Concise**: Encourages efficient building of flexible and _smart_ queries
* **Elegant**: Epure allows structure of your project to be as complicated or simple as you want

Installing
----------

Install and update using <a href="https://pip.pypa.io/en/stable/getting-started/">`pip`</a>:

```console
$ pip install -U epure
```

Install and update using <a href="https://python-poetry.org/docs/">`poetry`</a>:

```console
$ poetry add epure@latest
```

A Simple Epurized Class Example
----------------

Let's start with simple example for Epure, you will need your DataBase to be up and running.
We will be using PostgresSQL for this example.

!!! warning
    Note that you need to use __type hints__ for class attributes in order to save class to DB. Class attribute without a type-hint will not be saved in DB.

    If you dont know which type-hint you want to use, but still want to save your field: use `#!python object` type-hint and your instance will be saved as `#!js JSON`.

    Read more about supported types for type-hinting :arrow_right: <a href="https://epurelib.github.io/latest/learn/epure_cls/#supported-types-for-type-hinting-class-attributes">here</a> :arrow_left:

### Connect it

Connect Epure to your DB:

```python hl_lines="1 8 15 18 27 33"
from epure import epure, escript, GresDB
from ..epure.generics import NotNull # (1)!
from typing import List, Dict

GresDb('postgres://postgres:postgres@localhost:5432',
log_level=3).connect() # (2)!
```

1. Check out more about generic Epure types here: link
2. Format of string to connect ('database://user:password@host:port'); Note that there is two ways to connect to db, read here:

!!! tip "GresDB and supported DB's"
    Read more about GresDB class and supported by Epure DataBases :arrow_right: <a href="https://epurelib.github.io/latest/learn/supported_db/#supported-dbs-for-epure">here</a> :arrow_left:

### Define it

Define a class that you want to save as a table and its :magic_wand: _magic_ :magic_wand: method:

```python

@epure() # (3)!
class Example:
    int_attr:int
    str_attr:str
    float_attr:NotNull[float] = 3.14
    generic_list:List[int] = [3, 4, 8]

    def __init__(int_attr, str_attr="Hello World!"):
        self.int_attr = int_attr
        self.str_attr = str_attr

    @escript # (4)!
    def smart_query_example(self): [func]
        md = self.md # (5)!
        query = md.str_attr in ("Hello Sun!") # (6)!
        #↓↓↓
        # query = "SELECT public.example.str_attr IN ("Hello Sun!")"
        res = self.resource.read(query) # (7)!
        return res

```

3. `#!python @epure` is metaclass decorator function, that modifies class; more info here: 
4. `#!python @escript` is method decorator for @epure decorated classes; more info here:
5. note that md (short for `#!python Model`) is only available in @escript decorated method scope and only; more info here: 
6. read more about supported SQL operators in `#!python Epure` like `#!python in` here:
7. learn more about `#!python read()` here:

Read more about :magic_wand: _magic_ :magic_wand: methods and `#!python @escript` decorator :arrow_right: <a href="https://epurelib.github.io/latest/learn/escript_decorator/#magic-escript-decorator">here</a> :arrow_left:

### Save it

Create and save instances of your class as such:

```python

obj1 = Example(42)
obj1.save()

obj2 = Example(99, "Hello Sun!")
obj2.save()
```

### Retrieve it

Now when your instances saved in DB table named `#!sql public.example`, we can talk about __creating__ __queries__ __variations__:

#### 1. smart queries with use of `#!python @escript` magic method :star_struck:

<!-- Let's do some magic  : -->

Method itself becomes magical after we decorated it with `#!python @escript`. It will take your smart query and will turn it into a `#!sql SQL` string.

Passing it then to `#!python .read()` will retrieve `Example` object with `str_attr` with value `#!python "Hello Sun!"`.

And calling `#!python .smart_query_example()` method will :magic_wand: _magically_ :magic_wand: return your retrieved object. Viola!

<!-- Calling this method we are reading data from resource and we will get Epure objects as result -->

```python hl_lines="1"
res2 = obj2.smart_query_example() # -> list[list[epure_object]]

res2[0].int_attr # -> 99
res2[0].str_attr # -> "Hello Sun!"
```
Read more about :magic_wand: _magic_ :magic_wand: methods, `smart_queries` and `#!python @escript` decorator :arrow_right: <a href="https://epurelib.github.io/latest/learn/escript_decorator/#magic-escript-decorator">here</a> :arrow_left:


#### 2. shortcut :material-arrow-right-top-bold: `#!python read()` with kwarg parameters

Alternatively if you:

- know attribute by which you want to get set of objects

- have `data_id` (`UUID`) of specific object

you can use `.read()` method that takes key-word arguments and allows this ready to hand approach of getting objects
<!-- or you have a unique data_id of the object and you want to straight up retrieve it -->

```python hl_lines="4 9"

data_id = obj1.data_id # -> UUID4 # (1)!

# unique data_id of object
res1 = obj1.table.read(data_id=data_id) # -> list[<Example object at 0x0...>]

# or

# multiple attrs of object
res1 = Example.resource.read(str_attr="Hello World!", int_attr=42) # -> list[list[<Example object at 0x0...,>, ...]]

res1[0].int_attr # -> 42
res1[0].str_attr # -> "Hello World!"

```

1. data_id is a unique UUID object identifier that Epure uses to discriminate different objects

Read more about `.read()` :arrow_right: <a href="https://epurelib.github.io/latest/learn/joins/#advanced-example-with-two-joins">here</a> :arrow_left:

Advanced example with JoinResource
-----

Check out what is JoinResource and more advanced example with join :arrow_right:: <a href="https://epurelib.github.io/latest/learn/joins/#advanced-example-with-two-joins">here</a> :arrow_left::

Elist and Eset
-----

### Elist

<!-- Elist is really convenient in terms of using easy retrievable data collection. -->

Elist is really convenient in terms of using easy savable and retrievable data collection.

You can look at it like strictly typed list with an idea of simple saving and retrieving its contents from DB.

Elist can guarantee numerated order of objects when is used by user at a time.

But in cases of big system with multiple users please refer to <a href="https://epurelib.github.io/latest/#eset">Eset</a> :slight_smile:.

Let's look at an example:
???+ example "Elist example for storing and retrieving items"
    ```python hl_lines="10 19"
    from epure import epure, Elist

    @epure()
    class Example:
        int_attr:int = 42
        str_attr:str = "Hello World!"

    @epure()
    class ElistExample:
        elist_str:Elist[str] = Elist[str](["Like","a", "piece", "of", "cake"])
        elist_epure:Elist[Example]

    ex1 = Example()
    ex1.int_attr = 68

    ex2 = Example()

    elist_ex = ElistExample()
    elist_ex.elist_epure = Elist[Example]([ex1, ex2])
    elist_ex.save() # (1)!

    elist_ex_read = ElistExample.resource.read(data_id = elist_ex.data_id)

    elist_ex_read[0].elist_str[4] # -> "cake"
    elist_ex_read[0].elist_epure[0].int_attr # -> 68
    ```

    1. Saving this Epure instance with Elist field will triger saving for Elist

### Eset

Eset is similar to Elist, though it does not guarantee order of its stored contents.

It is convenient in cases when you need store big chunks of data. You can then easily retrieve part of data stored in it based on criteria specified

This is in a way our interpretation of many2many field.

???+ example "Eset example for storing, loading and retrieving items"

    ```python hl_lines="1 18 20 22 28 32" 
    from epure import epure, Eset

    @epure()
    class Example:
        int_attr:complex = 5 + 7j
        str_attr:str = "Hello Sky!"

    @epure()
    class EsetExample:
        eset_str:Eset[str]
        eset_epure:Eset[Example]

    ex1 = Example()
    ex2 = Example()

    eset_ex = EsetExample()

    eset_ex.eset_epure = Eset[Example]((ex1, ex2))

    eset_ex.eset_str = Eset[str](("Grin", "like", "a", "Cheshire", "cat"))

    eset_ex.save() # (1)!

    eset_ex_read = EsetExample.resource.read(data_id = eset_ex.data_id)[0]

    eset_ex_read.eset_epure # -> {}
    eset_ex_read.eset_epure.load() # (2)!
    eset_ex_read.eset_epure # -> {<Example object at 0x0...>, <Example object at 0x0...>}

    eset_ex_read.eset_str # -> {}
    eset_ex_read.eset_str.load() # (2)!
    "".join(eset_ex_read.eset_str) # -> "Cheshire Grin cat like a"
    ```

    1. Note that saving this will triger recursive saving for all elists and esets bounded to this object
    2. Eset is empty when is retrieved, you need to use .load() method of Eset to fill the eset with its content.

Serialization and deserialization of Epure objects
-----

Epure allows to __serialize__ your "epurized" class `#!python object` to `#!js JSON` using `.to_dict()` and `.to_json()` methods 

As much as it allows to __deserialize__ `#!js JSON` back to a Epure `#!python object` using `.from_dict()` and `.from_json()`

For __serialization__ with `.to_dict()` and `.to_json()` example head down :arrow_right: <a href="https://epurelib.github.io/latest/learn/serialization_deserialization/serialization/">here</a> :arrow_left:

And for __deserialization__ using `.from_dict()` and `.from_json()` check out example :arrow_right: <a href="https://epurelib.github.io/latest/learn/serialization_deserialization/deserialization/">here</a> :arrow_left:

Ini File Parser
-----

This section of library appeared mainly because there is no adequate solution for working with ini files in python

File Ini Parser allows to easily work with sections of `.ini` file using dot (`.`) notation

#### A small example

Save this as example.ini file:

```ini title="example.ini"
db_host = localhost

[general]
db_port = 5432

[epure.best.app.forever]
friend = true
```

Now we can easily access fields of this ini file:

```python hl_lines="5 7 9"
from epure.files import IniFile

config = IniFile('./example.ini')

config.db_host # -> "localhost"

config.general.db_port # -> 5432

config.epure.best.app.forever.friend # -> True

```

Learn more about Ini Parser :arrow_right: <a href="https://epurelib.github.io/latest/learn/ini_parser/">here</a> :arrow_left:

Developers
-----
Nikita Umarov (Pichugin), 
Pavel Pichugin

Sponsor us
-----


Links
-----

-   Documentation: https://github.com/nagvalhm/epure/blob/main/README.md
-   Changes: https://github.com/nagvalhm/epure
-   PyPI Releases: https://pypi.org/project/epure/
-   Source Code: https://github.com/nagvalhm/epure
-   Issue Tracker: https://github.com/nagvalhm/epure/issues
-   Website: https://pypi.org/project/epure/